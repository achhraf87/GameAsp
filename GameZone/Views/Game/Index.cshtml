@using GameZone.Settings
@* @model IEnumerable<Game> *@
@model ResponseGameDTO


@{
    ViewData["Title"] = "Games";
    //var paginationInfo = ViewData["PaginationInfo"] as PaginationInfo;

}


<div class="d-flex bd-highlight">
    <div class="p-2 w-100 bd-highlight">
        <a class="btn btn-secondary btn-lg" asp-action="Create">
            @* <i class="bi bi-plus-circle-dotted"></i> *@
            <i class="bi bi-person-fill-add"></i>
            Add Game
        </a>
    </div>
    <div class="p-2 flex-shrink-1 bd-highlight">
        <!-- Bouton pour imprimer en Excel -->
        <div class="mt-3">
            <form asp-action="ExportToExcel" method="post">
                <input type="hidden" name="searchTerm" value="@ViewBag.SearchTerm" />
                <button type="submit" class="btn btn-success"><i class="bi bi-file-earmark-spreadsheet"></i>Exporter</button>
            </form>
        </div>
    </div>
</div>



@if (!Model.Data.Any())
{
    <div class="alert alert-warning mt-5">
        <h4 class="alert-heading">No games!</h4>
        <p class="mb-0">No games were added yet.</p>
    </div>
}
else
{
    <!-- Formulaire de recherche -->
    <div class="mt-3 mb-3">
        <form asp-action="Index" method="get" class="form-inline">
            <div class="input-group">
                <input type="text" class="form-control" name="searchTerm" placeholder="Search by Name or Category">
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary"><i class="bi bi-search"></i></button>
                </div>
            </div>
        </form>
    </div>

@*     <!-- Formulaire de recherche -->
    <div class="mt-3 mb-3">
        <form asp-action="Index" method="get" class="form-inline">
            <div class="input-group">
                <input type="text" class="form-control" name="searchTerm" placeholder="Search by Name or Category">
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Search</button>
                </div>
            </div>
        </form>
    </div> *@

    <div class="mt-5">
        <table class="table table-bordered border-primary">
            <tbody>
                @foreach (var game in Model.Data)
                {
                    <tr class="border-1 border-success">
                        <td>
                            <div class="d-flex">
                                <div class="pe-4">
                                    <img src="@($"{FileSetting.fileName}/{game.Cover}")" alt="@game.Name" style="max-width: 90px" />
                                </div>
                                <div class="d-flex flex-column justify-content-center">
                                    <h4 class="text-light">@game.Name</h4>
                                    <h5>@game.Category.Name</h5>
                                </div>
                            </div>
                        </td>
                        <td class="align-middle">
                            <div class="d-flex justify-content-end">
                                <a class="btn btn-info rounded rounded-3 me-2" asp-action="Edit" asp-route-id="@game.Id">
                                    <i class="bi bi-pencil-fill"></i>
                                </a>
                                <a href="javascript:;" class="btn btn-danger rounded rounded-3 js-delete" data-id="@game.Id">
                                    <i class="bi bi-trash3"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <!-- Ajouter les liens de pagination -->
        @if (Model.pagination != null && Model.RecordTotal > 1)
        {
            <div class="mt-5">
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        @for (int i = 1; i <= Model.pagination.TotalPages; i++) 
                        {
                            <li class="page-item @(i == Model.pagination.PageNumber ? "active" : "")">
                                <a class="page-link" asp-action="Index" asp-route-pageNumber="@i">@i</a>
                            </li>
                        }
                    </ul>
                </nav>
            </div>
        }

        <div class="text">
            @($"total {this.Model.RecordFiltred}/{this.Model.RecordTotal}")
        </div>

        

    </div>

   
}



@section Scripts
{
    <script src="~/js/games-index.js" asp-append-version="true"></script>
}
